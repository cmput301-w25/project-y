@startuml
skinparam classAttributeIconSize 0
class FollowingMoodEventListActivity {
    # onCreate(Bundle)
}
FollowingMoodEventListActivity --|> MoodListActivity

class LocationController {
    - activity : Activity
    - fusedLocationProviderClient : FusedLocationProviderClient
    - permissionLauncher : ActivityResultLauncher<String>
    - locationCallback : LocationCallback
    + LocationController(Activity)
    + getCurrentLocation(LocationCallback)
    - fetchLocationInternal()
}

class UserRepository {
    - {static} instance : UserRepository
    - db : FirebaseFirestore
    + {static} USER_COLLECTION : String
    - usersRef : CollectionReference
    - UserRepository()
    + UserRepository(FirebaseFirestore)
    + {static} getInstance() : UserRepository
    + {static} setInstanceForTesting(FirebaseFirestore)
    - startListening()
    + addUser(User, OnSuccessListener<User>, OnFailureListener)
    + doesUserExist(String, OnSuccessListener<User>, OnFailureListener)
    + getUser(String, OnSuccessListener<User>, OnFailureListener)
    + getFollowing(String, OnSuccessListener<ArrayList<String>>, OnFailureListener)
    + getFollowingMoodList(ArrayList<String>, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getFollowedPublicMoodEventsWithLocation(String, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getFollowStatusHashMap(String, OnSuccessListener<HashMap<String,FollowStatus>>, OnFailureListener)
    + getFollowerCount(String, OnSuccessListener<Integer>, OnFailureListener)
    + getAllUsers(OnSuccessListener<ArrayList<User>>, OnFailureListener)
    + getMostRecentEmotionFrom(String, OnSuccessListener<Emotion>, OnFailureListener)
    - onUserAdded(User)
}
UserRepository --|> GenericRepository

class FollowRequestsActivity {
    controller : FollowRequestController
    NoFollowRequests : TextView
    + setvisible()
    + setnotvisible()
    # onCreate(Bundle)
    # onStop()
    # getActivityLayout() : int
}
FollowRequestsActivity --|> BaseActivity

class UpdateOrDeleteMoodEventController {
    - session : SessionManager
    + UpdateOrDeleteMoodEventController(Context)
    + onUpdateMoodEvent(MoodEvent, OnSuccessListener<MoodEvent>, OnFailureListener)
    + onDeleteMoodEvent(MoodEvent, OnSuccessListener<String>, OnFailureListener)
}

class MoodEventArrayAdapter {
    - isUsernameActive : boolean
    - moodEvents : ArrayList<MoodEvent>
    - context : Context
    - followStatus : HashMap<String,UserRepository.FollowStatus>
    - imageCache : LruCache<String,Bitmap>
    + MoodEventArrayAdapter(Context, ArrayList<MoodEvent>, HashMap<String,UserRepository.FollowStatus>)
    + getView(int, View, ViewGroup) : View
    + getItemViewType(int) : int
    + getViewTypeCount() : int
    - handleException(Exception)
    + followStatusPut(String, UserRepository.FollowStatus)
    + deactivateUsernames()
}

class AddMoodController {
    - loggedInUser : String
    - context : Context
    + AddMoodController()
    + AddMoodController(Context)
    + onSubmitMood(MoodEvent, Uri, OnSuccessListener<MoodEvent>, OnFailureListener)
    - getImageSize(Uri) : long
    + setLoggedInUser(String)
}

class CommentArrayAdapter {
    - context : Context
    - commentsForMoodEvent : ArrayList<Comment>
    + CommentArrayAdapter(Context, ArrayList<Comment>)
    + getView(int, View, ViewGroup) : View
}

class DiscoverController {
    + DiscoverController(Context, OnSuccessListener<Void>, OnFailureListener)
    + doesBelongInOriginal(MoodEvent) : boolean
    + isPosterAllowed(String) : boolean
}
DiscoverController --|> MoodListController

class EnhancedMoodActivity {
    - imageCache : LruCache<String,Bitmap>
    - border : LinearLayout
    - location : GeoPoint
    - backButton : ImageButton
    - commentButton : Button
    - posterUsername : TextView
    - emoticon : TextView
    - dateTime : TextView
    - controller : CommentController
    - locationTextView : TextView
    - socialSituation : TextView
    - moodText : TextView
    - editButton : ImageButton
    - sessionManager : SessionManager
    - photoImgView : ImageView
    - newComment : EditText
    - moodEventId : String
    - currentMoodEvent : MoodEvent
    # onCreate(Bundle)
    - handleException(Exception)
    # onResume()
    - setUI()
}

class BaseActivity {
    - MOOD_FOLLOWING_LIST_UNSELECTED : Drawable
    - MOOD_FOLLOWING_LIST_SELECTED : Drawable
    - DISCOVER_UNSELECTED : Drawable
    - DISCOVER_SELECTED : Drawable
    - SEARCH_UNSELECTED : Drawable
    - SEARCH_SELECTED : Drawable
    - MAP_UNSELECTED : Drawable
    - MAP_SELECTED : Drawable
    - PROFILE_UNSELECTED : Drawable
    - PROFILE_SELECTED : Drawable
    - moodFollowingListBtn : ImageButton
    - discoverBtn : ImageButton
    - searchBtn : ImageButton
    - mapBtn : ImageButton
    - profileBtn : ImageButton
    # onCreate(Bundle)
    # {abstract} getActivityLayout() : int
    # deselectAllHeaderButtons()
    # selectMoodFollowingListHeaderButton()
    # selectDiscoverHeaderButton()
    # selectSearchHeaderButton()
    # selectMapHeaderButton()
    # selectProfileHeaderButton()
}

class LoginActivity {
    - usernameEditText : EditText
    - loginController : LoginController
    # onCreate(Bundle)
    - loginUser()
}

class FollowRequestRepository {
    - {static} instance : FollowRequestRepository
    + {static} FOLLOW_REQ_COLLECTION : String
    - db : FirebaseFirestore
    - followReqsRef : CollectionReference
    - FollowRequestRepository()
    - FollowRequestRepository(FirebaseFirestore)
    + {static} getInstance() : FollowRequestRepository
    + {static} setInstanceForTesting(FirebaseFirestore)
    + addFollowRequest(FollowRequest, OnSuccessListener<FollowRequest>, OnFailureListener)
    + getFollowRequest(String, String, OnSuccessListener<FollowRequest>, OnFailureListener)
    + deleteFollowRequest(String, String, OnSuccessListener<Void>, OnFailureListener)
    + didRequest(String, String, OnSuccessListener<Boolean>, OnFailureListener)
    + acceptRequest(FollowRequest, OnSuccessListener<Follow>, OnFailureListener)
    + getAllRequestsTo(String, OnSuccessListener<ArrayList<FollowRequest>>, OnFailureListener)
    + getAllRequestsFrom(String, OnSuccessListener<ArrayList<FollowRequest>>, OnFailureListener)
    - getCompoundId(String, String) : String
    - onFollowRequestAdded(FollowRequest)
    - onFollowRequestDeleted(String, String)
}
FollowRequestRepository --|> GenericRepository

class FollowRequestController {
    - user : String
    - context : Context
    - adapter : FollowRequestArrayAdapter
    - reqs : ArrayList<FollowRequest>
    + FollowRequestController()
    + FollowRequestController(Context, OnSuccessListener<Void>, OnFailureListener)
    + onFollowRequestAdded(FollowRequest)
    + onFollowRequestDeleted(String, String)
    + onActivityStop()
    # insertReq(FollowRequest)
    - notifyAdapter()
    + getAdapter() : FollowRequestArrayAdapter
    + getReqs() : ArrayList<FollowRequest>
    + setReqs(ArrayList<FollowRequest>)
    - updateEmptyState()
}
FollowRequestController ..|> FollowRequestListener

class FollowRequest {
    - requester : String
    - requestee : String
    - timestamp : Timestamp
    + FollowRequest()
    + FollowRequest(String, String, Timestamp)
    + getRequester() : String
    + setRequester(String)
    + getRequestee() : String
    + setRequestee(String)
    + getTimestamp() : Timestamp
    + setTimestamp(Timestamp)
}

class UserProfileActivity {
    - controller : MoodListController
    - followButton : FollowButton
    - session : SessionManager
    - targetUser : String
    - followerCountTv : TextView
    - moodListView : ListView
    - backBtn : ImageButton
    # onCreate(Bundle)
    # getActivityLayout() : int
    + onFollowAdded(Follow)
    + onFollowDeleted(String, String)
    - initMyProfile()
    + onFollowRequestAdded(FollowRequest)
    + onFollowRequestDeleted(String, String)
}
UserProfileActivity ..|> FollowListener
UserProfileActivity ..|> FollowRequestListener
UserProfileActivity --|> BaseActivity

class MyProfileActivity {
    # onCreate(Bundle)
    # getActivityLayout() : int
}
MyProfileActivity --|> BaseActivity

class MoodAddActivity {
    - {static} TAG : String
    SELECT_PICTURE : int
    - addMoodController : AddMoodController
    - spinnerMood : Spinner
    - checkShareLocation : CheckBox
    - etReasonWhyText : EditText
    - datePicked : EditText
    - selectedImageUri : Uri
    - privateCheckBox : CheckBox
    - btnSubmit : Button
    - btnInsertImage : ImageButton
    - session : SessionManager
    - socialSituation : SocialSituation
    - locationController : LocationController
    # onCreate(Bundle)
    - initializeBorderColors()
    - showDatePickerDialog(EditText)
    - images()
    + onActivityResult(int, int, Intent)
    - submitMood(MoodEvent)
    - makeSocialSpinner()
}

class DiscoverActivity {
    # onCreate(Bundle)
}
DiscoverActivity --|> MoodListActivity

class FollowRepository {
    - {static} instance : FollowRepository
    + {static} FOLLOW_COLLECTION : String
    - db : FirebaseFirestore
    - followsRef : CollectionReference
    - FollowRepository()
    - FollowRepository(FirebaseFirestore)
    + {static} getInstance() : FollowRepository
    + {static} setInstanceForTesting(FirebaseFirestore)
    + addFollow(Follow, OnSuccessListener<Follow>, OnFailureListener)
    + getFollow(String, String, OnSuccessListener<Follow>, OnFailureListener)
    + deleteFollow(String, String, OnSuccessListener<Void>, OnFailureListener)
    + isFollowing(String, String, OnSuccessListener<Boolean>, OnFailureListener)
    + {static} getCompoundId(String, String) : String
    - onFollowAdded(Follow)
    - onFollowDeleted(String, String)
}
FollowRepository --|> GenericRepository

class User {
    - username : String
    - hashedPassword : String
    - name : String
    - email : String
    - joinDateTime : Timestamp
    + User()
    + User(String, String, String, String)
    + User(String, String, String, String, Timestamp)
    + getUsername() : String
    + setUsername(String)
    + getHashedPassword() : String
    + setHashedPassword(String)
    + getName() : String
    + setName(String)
    + getEmail() : String
    + setEmail(String)
    + getJoinDateTime() : Timestamp
    + setJoinDateTime(Timestamp)
}

class MoodEventListFilter {
    - minDateTime : Timestamp
    - maxDateTime : Timestamp
    - emotion : Emotion
    - reasonWhyTextKeyword : String
    - sharedLocation : boolean
    + MoodEventListFilter()
    + MoodEventListFilter(Timestamp, Timestamp, Emotion, String, boolean)
    + applyFilter(ArrayList<MoodEvent>) : ArrayList<MoodEvent>
    + wouldBeFiltered(MoodEvent) : boolean
    + getMinDateTime() : Timestamp
    + setMinDateTime(Timestamp)
    + clearMinDateTime()
    + getMaxDateTime() : Timestamp
    + setMaxDateTime(Timestamp)
    + clearMaxDateTime()
    + getEmotion() : Emotion
    + setEmotion(Emotion)
    + clearEmotion()
    + getReasonWhyTextKeyword() : String
    + setReasonWhyTextKeyword(String)
    + clearReasonWhyKeyword()
    + setSharedLocation()
    + clearSharedLocation()
}

class SearchController {
    - context : Context
    - session : SessionManager
    - allUsers : ArrayList<User>
    - searchResult : ArrayList<User>
    - adapter : SearchResultArrayAdapter
    - followStatus : HashMap<String,UserRepository.FollowStatus>
    + SearchController(Context)
    + initializeAdapter(OnSuccessListener<Void>, OnFailureListener)
    + searchUsers(String)
    + onUserAdded(User)
    + onFollowAdded(Follow)
    + onFollowDeleted(String, String)
    + onFollowRequestAdded(FollowRequest)
    + onFollowRequestDeleted(String, String)
    + getAdapter() : SearchResultArrayAdapter
    # notifyAdapter()
}
SearchController ..|> UserListener
SearchController ..|> FollowListener
SearchController ..|> FollowRequestListener

class MainActivity {
    # onCreate(Bundle)
}

class CommentController {
    - commenter : String
    - context : Context
    - commentArrayAdapter : CommentArrayAdapter
    - commentsList : ArrayList<Comment>
    - moodEventToComment : MoodEvent
    + CommentController()
    + CommentController(MoodEvent, Context, OnSuccessListener<Void>, OnFailureListener)
    + onCommentAdded(Comment)
    - notifyAdapter()
    + getAdapter() : CommentArrayAdapter
    + addComment(String)
}
CommentController ..|> CommentListener

class MoodEventRepository {
    - {static} instance : MoodEventRepository
    + {static} MOOD_EVENT_COLLECTION : String
    + {static} MOOD_PHOTO_STORAGE_NAME : String
    - db : FirebaseFirestore
    - moodEventRef : CollectionReference
    - MoodEventRepository()
    - MoodEventRepository(FirebaseFirestore)
    + {static} getInstance() : MoodEventRepository
    - startListening()
    + {static} setInstanceForTesting(FirebaseFirestore)
    + addMoodEvent(MoodEvent, OnSuccessListener<MoodEvent>, OnFailureListener)
    + getMoodEvent(String, OnSuccessListener<MoodEvent>, OnFailureListener)
    + updateMoodEvent(MoodEvent, OnSuccessListener<MoodEvent>, OnFailureListener)
    + deleteMoodEvent(String, OnSuccessListener<String>, OnFailureListener)
    + getAllPublicMoodEvents(OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getAllPublicMoodEventsFrom(String, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getRecentPublicMoodEventsFrom(String, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getAllPrivateMoodEventsFrom(String, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + uploadAndAttachImage(MoodEvent, Uri, OnSuccessListener<MoodEvent>, OnFailureListener)
    + downloadImage(String, OnSuccessListener<Bitmap>, OnFailureListener)
    - onMoodEventAdded(MoodEvent)
    - onMoodEventUpdated(MoodEvent)
    - onMoodEventDeleted(String)
}
MoodEventRepository --|> GenericRepository

class CommentRepository {
    + {static} COMMENT_COLLECTION : String
    - {static} instance : CommentRepository
    - db : FirebaseFirestore
    - commentsRef : CollectionReference
    - CommentRepository()
    - CommentRepository(FirebaseFirestore)
    + {static} getInstance() : CommentRepository
    + {static} setInstanceForTesting(FirebaseFirestore)
    - startListening()
    + addComment(Comment, OnSuccessListener<Comment>, OnFailureListener)
    + getAllCommentsFromMood(String, OnSuccessListener<ArrayList<Comment>>, OnFailureListener)
    - onCommentAdded(Comment)
}
CommentRepository --|> GenericRepository

class GenericTextWatcher {
    - editText : EditText
    - errorMsg : String
    - confrimEditText : EditText
    - reasonWhy : String
    + GenericTextWatcher(EditText, String)
    + GenericTextWatcher(EditText, EditText, String)
    + GenericTextWatcher(EditText, String, String)
    + beforeTextChanged(CharSequence, int, int, int)
    + onTextChanged(CharSequence, int, int, int)
    + afterTextChanged(Editable)
    + valid()
    + validateReasonWhy()
}
GenericTextWatcher ..|> TextWatcher

class MoodHistoryActivity {
    - user : String
    # onCreate(Bundle)
    + getUser() : String
}
MoodHistoryActivity --|> MoodListActivity

class MoodListActivity {
    # controller : MoodListController
    # moodListView : ListView
    # onCreate(Bundle)
    - initializeMinDateFilter()
    - initializeMaxDateFilter()
    - initializeEmotionSpinner()
    - initializeReasonWhyKeywordFilter()
    - showDatePickerDialog(Timestamp, DatePickerDialog.OnDateSetListener)
    # onMoodClick(MoodEvent)
    # initializeMoodClick()
    # getActivityLayout() : int
    # handleException(Exception)
}
MoodListActivity --|> BaseActivity

class FollowRequestArrayAdapter {
    - context : Context
    - requests : ArrayList<FollowRequest>
    + FollowRequestArrayAdapter(Context, ArrayList<FollowRequest>)
    + getView(int, View, ViewGroup) : View
    - handleException(Exception)
}

class MapActivity {
    - mMap : GoogleMap
    - spinnerOptions : Spinner
    - locationMoodController : LocationMoodController
    - locationController : LocationController
    - {static} TAG : String
    # onCreate(Bundle)
    + onMapReady(GoogleMap)
    - updateMapMarkers(int)
    - drawMarkers(ArrayList<MoodEvent>)
    - getBitmapFromView(View) : Bitmap
    # getActivityLayout() : int
}
MapActivity ..|> OnMapReadyCallback
MapActivity --|> BaseActivity

class PersonalJournalController {
    + PersonalJournalController(Context, OnSuccessListener<Void>, OnFailureListener)
    + doesBelongInOriginal(MoodEvent) : boolean
    + isPosterAllowed(String) : boolean
}
PersonalJournalController --|> MoodListController

class SignUpActivity {
    - signUpController : SignUpController
    - nameField : EditText
    - emailField : EditText
    - confirmEmailField : EditText
    - usernameField : EditText
    - passwordField : EditText
    - confirmPasswordField : EditText
    # onCreate(Bundle)
    - signUpUser()
}

class MoodEvent {
    + {static} CREATOR : Creator<MoodEvent>
    - id : String
    - creationDateTime : Timestamp
    - posterUsername : String
    - dateTime : Timestamp
    - emotion : Emotion
    - isPrivate : Boolean
    - socialSituation : SocialSituation
    - trigger : String
    - text : String
    - photoURL : String
    - location : GeoPoint
    + MoodEvent()
    + MoodEvent(String, Timestamp, String, Timestamp, Emotion)
    # MoodEvent(Parcel)
    + getId() : String
    + setId(String)
    + getCreationDateTime() : Timestamp
    + setCreationDateTime(Timestamp)
    + getDateTime() : Timestamp
    + setDateTime(Timestamp)
    + getPosterUsername() : String
    + setPosterUsername(String)
    + getEmotion() : Emotion
    + setEmotion(Emotion)
    + getSocialSituation() : SocialSituation
    + setSocialSituation(SocialSituation)
    + getText() : String
    + setText(String)
    + getPhotoURL() : String
    + setPhotoURL(String)
    + getLocation() : GeoPoint
    + setLocation(GeoPoint)
    + getIsPrivate() : Boolean
    + setIsPrivate(Boolean)
    + getStability() : int
    + describeContents() : int
    + writeToParcel(Parcel, int)
    + equals(Object) : boolean
    + hashCode() : int
    + toString() : String
}

class LoginController {
    - authManager : AuthManager
    + LoginController()
    + LoginController(Context)
    + onLoginUser(String, String, OnSuccessListener<User>, OnFailureListener)
    + setAuthManager(AuthManager)
}

class LocationMoodController {
    - session : SessionManager
    - userRepo : UserRepository
    - moodEventRepo : MoodEventRepository
    + LocationMoodController(Context)
    + getMoodEventsWithLocation(OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getMoodEventsWithLocationAndFollowed(OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    + getMoodEventWithin5kmFromUser(Location, OnSuccessListener<ArrayList<MoodEvent>>, OnFailureListener)
    - isWithin5km(MoodEvent, Location) : boolean
    - haversine(double, double, double, double) : double
}

class MarkerData {
    coordinate : LatLng
    emoticon : String
    username : String
    MarkerData(LatLng, String, String)
}

class SearchResultArrayAdapter {
    - context : Context
    - users : ArrayList<User>
    - followStatus : HashMap<String,UserRepository.FollowStatus>
    - emotionCache : HashMap<String,Emotion>
    + SearchResultArrayAdapter(Context, ArrayList<User>, HashMap<String,UserRepository.FollowStatus>)
    + getView(int, View, ViewGroup) : View
    + followStatusPut(String, UserRepository.FollowStatus)
}

class MoodListController {
    # context : Context
    # filter : MoodEventListFilter
    # originalMoodEventList : ArrayList<MoodEvent>
    # filteredMoodEventList : ArrayList<MoodEvent>
    # moodAdapter : MoodEventArrayAdapter
    # session : SessionManager
    + MoodListController(Context)
    # initializeArrayAdapter(ArrayList<MoodEvent>, HashMap<String,UserRepository.FollowStatus>)
    + {abstract} doesBelongInOriginal(MoodEvent) : boolean
    + {abstract} isPosterAllowed(String) : boolean
    + saveFilter()
    + onFollowAdded(Follow)
    + onFollowDeleted(String, String)
    + onFollowRequestAdded(FollowRequest)
    + onFollowRequestDeleted(String, String)
    # shouldUpdateOnFollowStatusUpdate(String, String) : boolean
    + onMoodEventAdded(MoodEvent)
    + onMoodEventDeleted(String)
    + onMoodEventUpdated(MoodEvent)
    # insertMoodEventSortedDateTime(ArrayList<MoodEvent>, MoodEvent)
    # notifyAdapter()
    + getFilter() : MoodEventListFilter
    + getMoodAdapter() : MoodEventArrayAdapter
    + getFilteredMoodEvent(int) : MoodEvent
}
MoodListController ..|> MoodEventListener
MoodListController ..|> FollowListener
MoodListController ..|> FollowRequestListener

class SessionManager {
    - {static} preferenceName : String
    - {static} isLoggedInKey : String
    - {static} usernameKey : String
    - prefs : SharedPreferences
    - editor : SharedPreferences.Editor
    + SessionManager(Context)
    + saveSession(String)
    + isLoggedIn() : boolean
    + getUsername() : String
    + logout()
}

class FollowingMoodListController {
    - moodCount : HashMap<String,Integer>
    + FollowingMoodListController(Context, OnSuccessListener<Void>, OnFailureListener)
    - isFollowing(String) : boolean
    - insertInMoodLists(MoodEvent) : boolean
    - removeFromMoodLists(String) : boolean
    + doesBelongInOriginal(MoodEvent) : boolean
    + isPosterAllowed(String) : boolean
    + onMoodEventAdded(MoodEvent)
    + onMoodEventUpdated(MoodEvent)
    + onMoodEventDeleted(String)
    + onFollowAdded(Follow)
    + onFollowDeleted(String, String)
}
FollowingMoodListController --|> MoodListController

class Follow {
    - followerUsername : String
    - followedUsername : String
    - timestamp : Timestamp
    + Follow()
    + Follow(String, String)
    + Follow(String, String, Timestamp)
    + getFollowerUsername() : String
    + setFollowerUsername(String)
    + getFollowedUsername() : String
    + setFollowedUsername(String)
    + getTimestamp() : Timestamp
    + setTimestamp(Timestamp)
}

class SignUpController {
    - authManager : AuthManager
    + SignUpController()
    + SignUpController(Context)
    + onSignUpUser(String, String, String, String, String, String, OnSuccessListener<User>, OnFailureListener)
}

class UpdateOrDeleteMoodEventActivity {
    - imageCache : LruCache<String,Bitmap>
    - spinnerMood : Spinner
    - spinnerSocial : Spinner
    - checkShareLocation : CheckBox
    - privateCheckbox : CheckBox
    - moodTextEditText : EditText
    - updateOrDeleteMoodEventController : UpdateOrDeleteMoodEventController
    - locationController : LocationController
    - photoImgView : ImageView
    # onCreate(Bundle)
    - onUpdateMoodEvent(MoodEvent)
    - onDeleteMoodEvent(MoodEvent)
    - handleException(Exception)
    - initializeBorderColors()
}

class AuthManager {
    - sessionManager : SessionManager
    + AuthManager(Context)
    + login(String, String, OnSuccessListener<User>, OnFailureListener)
    + signUp(String, String, String, String, OnSuccessListener<User>, OnFailureListener)
    - hashPassword(String) : String
}

class Comment {
    - id : String
    - moodEventId : String
    - timestamp : Timestamp
    - posterUsername : String
    - text : String
    + Comment()
    + getId() : String
    + setId(String)
    + getMoodEventId() : String
    + setMoodEventId(String)
    + getTimestamp() : Timestamp
    + setTimestamp(Timestamp)
    + getPosterUsername() : String
    + setPosterUsername(String)
    + getText() : String
    + setText(String)
}

class PersonalJournalActivity {
    # onCreate(Bundle)
}
PersonalJournalActivity --|> MoodListActivity

class FollowButton {
    - context : Context
    - loggedInUser : String
    - profileUser : String
    - followStatus : UserRepository.FollowStatus
    + FollowButton(Context, AttributeSet)
    + initialize(String, UserRepository.FollowStatus)
    - setStyles()
    - onClick(View)
    + hide()
    - handleException(Exception)
    + setFollowStatus(UserRepository.FollowStatus)
    + getFollowStatus() : UserRepository.FollowStatus
}
FollowButton --|> AppCompatButton

class MoodHistoryController {
    - poster : String
    + MoodHistoryController(Context, String, OnSuccessListener<Void>, OnFailureListener)
    + doesBelongInOriginal(MoodEvent) : boolean
    + isPosterAllowed(String) : boolean
}
MoodHistoryController --|> MoodListController

class GenericRepository {
    # listeners : Set<Listener>
    + addListener(Listener) : boolean
    + removeListener(Listener)
}

class SearchActivity {
    - controller : SearchController
    # onCreate(Bundle)
    # getActivityLayout() : int
}
SearchActivity --|> BaseActivity
LocationController--"- locationCallback" LocationCallback
UserRepository--"- {static} instance" UserRepository
FollowRequestsActivity--"controller" FollowRequestController
UpdateOrDeleteMoodEventController--"- session" SessionManager
EnhancedMoodActivity--"- controller" CommentController
EnhancedMoodActivity--"- sessionManager" SessionManager
EnhancedMoodActivity--"- currentMoodEvent" MoodEvent
LoginActivity--"- loginController" LoginController
FollowRequestRepository--"- {static} instance" FollowRequestRepository
FollowRequestController--"- adapter" FollowRequestArrayAdapter
UserProfileActivity--"- controller" MoodListController
UserProfileActivity--"- followButton" FollowButton
UserProfileActivity--"- session" SessionManager
MoodAddActivity--"- addMoodController" AddMoodController
MoodAddActivity--"- session" SessionManager
MoodAddActivity--"- socialSituation" SocialSituation
MoodAddActivity--"- locationController" LocationController
FollowRepository--"- {static} instance" FollowRepository
MoodEventListFilter--"- emotion" Emotion
SearchController--"- session" SessionManager
SearchController--"- adapter" SearchResultArrayAdapter
CommentController--"- commentArrayAdapter" CommentArrayAdapter
CommentController--"- moodEventToComment" MoodEvent
MoodEventRepository--"- {static} instance" MoodEventRepository
CommentRepository--"- {static} instance" CommentRepository
MoodListActivity--"# controller" MoodListController
MapActivity--"- locationMoodController" LocationMoodController
MapActivity--"- locationController" LocationController
SignUpActivity--"- signUpController" SignUpController
MoodEvent--"- emotion" Emotion
MoodEvent--"- socialSituation" SocialSituation
LoginController--"- authManager" AuthManager
LocationMoodController--"- session" SessionManager
LocationMoodController--"- userRepo" UserRepository
LocationMoodController--"- moodEventRepo" MoodEventRepository
MoodListController--"# filter" MoodEventListFilter
MoodListController--"# moodAdapter" MoodEventArrayAdapter
MoodListController--"# session" SessionManager
SignUpController--"- authManager" AuthManager
UpdateOrDeleteMoodEventActivity--"- updateOrDeleteMoodEventController" UpdateOrDeleteMoodEventController
UpdateOrDeleteMoodEventActivity--"- locationController" LocationController
AuthManager--"- sessionManager" SessionManager
SearchActivity--"- controller" SearchController

interface CommentListener {
    onCommentAdded(Comment)
}

interface MoodEventListener {
    onMoodEventAdded(MoodEvent)
    onMoodEventUpdated(MoodEvent)
    onMoodEventDeleted(String)
}

interface LocationCallback {
    onLocationRetrieved(Location)
}

interface FollowListener {
    onFollowAdded(Follow)
    onFollowDeleted(String, String)
}

interface UserListener {
    onUserAdded(User)
}

interface FollowRequestListener {
    onFollowRequestAdded(FollowRequest)
    onFollowRequestDeleted(String, String)
}

enum Emotion {
    ANGER
    CONFUSION
    DISGUST
    FEAR
    HAPPINESS
    SADNESS
    SHAME
    SURPRISE
    LAUGHTER
}

enum FollowStatus {
    FOLLOWING
    REQUESTED
    NEITHER
}

enum SocialSituation {
    ALONE
    ONE_OTHER
    TWO_OR_MORE_OTHERS
    CROWD
}
@enduml
